{
  "id": "snapshot_1764894715540_eo2wxv0zr",
  "approvalId": "approval_1764894715536_w5mr5lh46",
  "approvalTitle": "Design: Fully Functional Skeleton",
  "version": 1,
  "timestamp": "2025-12-05T00:31:55.540Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Design Document: Fully Functional Skeleton\r\n\r\n## Overview\r\n\r\nThis design document details the technical implementation of the Fully Functional Skeleton for an Angular v21 enterprise application. The skeleton establishes the foundational architecture including directory structure, visual system (Tailwind CSS + PrimeNG), core services (AuthService, Error Handling, Configuration), routing with lazy loading, and developer experience enhancements (path aliases).\r\n\r\n## Steering Document Alignment\r\n\r\n### Technical Standards (tech.md)\r\n\r\n| Standard | Implementation |\r\n|----------|----------------|\r\n| **Zoneless Architecture** | No Zone.js dependencies; all state via Signals |\r\n| **Signal-based State** | AuthService exposes `currentUser`, `isLoggedIn`, `isLoading` as Signals |\r\n| **RxJS Internal Only** | BehaviorSubjects used internally in services; `toSignal()` for public API |\r\n| **OnPush Change Detection** | All components use `ChangeDetectionStrategy.OnPush` |\r\n| **Standalone Components** | All components are `standalone: true` |\r\n| **Modern Control Flow** | `@if`, `@for`, `@switch` instead of structural directives |\r\n| **Function-based I/O** | `input()`, `output()` instead of decorators |\r\n| **inject() Function** | No constructor injection |\r\n\r\n### Project Structure (structure.md)\r\n\r\n```\r\nsrc/app/\r\n├── core/                          # Singleton Layer\r\n│   ├── auth/\r\n│   │   ├── auth.service.ts        # Signal-based auth state\r\n│   │   ├── auth.guard.ts          # Route protection (placeholder)\r\n│   │   └── auth.interceptor.ts    # HTTP auth headers (placeholder)\r\n│   ├── layout/\r\n│   │   ├── admin-layout/          # Post-login shell\r\n│   │   │   └── admin-layout.component.ts\r\n│   │   ├── blank-layout/          # Pre-login shell\r\n│   │   │   └── blank-layout.component.ts\r\n│   │   ├── header/\r\n│   │   │   └── header.component.ts\r\n│   │   ├── sidebar/\r\n│   │   │   └── sidebar.component.ts\r\n│   │   └── footer/\r\n│   │       └── footer.component.ts\r\n│   ├── config/\r\n│   │   └── app.config.ts          # APP_CONFIG InjectionToken\r\n│   └── services/\r\n│       ├── error.handler.ts       # GlobalErrorHandler\r\n│       └── error.interceptor.ts   # HTTP error interceptor\r\n├── shared/                        # Reusable Layer (zero business logic)\r\n│   ├── ui/\r\n│   │   └── .gitkeep\r\n│   ├── pipes/\r\n│   │   └── .gitkeep\r\n│   ├── directives/\r\n│   │   └── .gitkeep\r\n│   └── utils/\r\n│       └── .gitkeep\r\n└── features/                      # Business Layer (lazy-loaded)\r\n    ├── home/\r\n    │   ├── home.routes.ts\r\n    │   └── home.component.ts\r\n    ├── auth/\r\n    │   ├── auth.routes.ts\r\n    │   └── login/\r\n    │       └── login.component.ts\r\n    └── not-found/\r\n        └── not-found.component.ts\r\n```\r\n\r\n## Code Reuse Analysis\r\n\r\n### Existing Components to Leverage\r\n\r\n- **PrimeNG Components**: Button, Menu, Sidebar, Toolbar for layout UI\r\n- **Tailwind CSS**: Utility classes for spacing, typography, responsive design\r\n- **Angular Router**: Built-in lazy loading, guards, route data\r\n\r\n### Integration Points\r\n\r\n- **HttpClient**: Configured with interceptors via `provideHttpClient(withInterceptors([...]))`\r\n- **PrimeNG Theme**: Aura theme from `@primeuix/themes` integrated in `app.config.ts`\r\n\r\n---\r\n\r\n## Architecture\r\n\r\n### High-Level Architecture\r\n\r\n```mermaid\r\ngraph TB\r\n    subgraph \"App Shell\"\r\n        AppComponent[app.component.ts]\r\n        RouterOutlet[router-outlet]\r\n    end\r\n\r\n    subgraph \"Layouts\"\r\n        AdminLayout[AdminLayoutComponent]\r\n        BlankLayout[BlankLayoutComponent]\r\n    end\r\n\r\n    subgraph \"Core Services\"\r\n        AuthService[AuthService<br/>Signals: currentUser, isLoggedIn]\r\n        AppConfig[APP_CONFIG<br/>InjectionToken]\r\n        ErrorHandler[GlobalErrorHandler]\r\n    end\r\n\r\n    subgraph \"Features (Lazy)\"\r\n        Home[HomeComponent]\r\n        Login[LoginComponent]\r\n        NotFound[NotFoundComponent]\r\n    end\r\n\r\n    AppComponent --> RouterOutlet\r\n    RouterOutlet --> AdminLayout\r\n    RouterOutlet --> BlankLayout\r\n    AdminLayout --> Home\r\n    BlankLayout --> Login\r\n    RouterOutlet --> NotFound\r\n\r\n    AdminLayout --> AuthService\r\n    Home --> AuthService\r\n    Login --> AuthService\r\n```\r\n\r\n### Modular Design Principles\r\n\r\n- **Single File Responsibility**: Each component/service handles one concern\r\n- **Component Isolation**: Layout components are separate from feature components\r\n- **Service Layer Separation**: AuthService manages auth state; Interceptors handle HTTP concerns\r\n- **Utility Modularity**: Shared utilities in `@shared/utils/` for cross-cutting concerns\r\n\r\n---\r\n\r\n## Components and Interfaces\r\n\r\n### 1. AuthService\r\n\r\n- **Location**: `@core/auth/auth.service.ts`\r\n- **Purpose**: Manage authentication state using Signals\r\n- **Public API**:\r\n  ```typescript\r\n  readonly currentUser: Signal<User | null>\r\n  readonly isLoggedIn: Signal<boolean>\r\n  readonly isLoading: Signal<boolean>\r\n  login(credentials: LoginCredentials): void\r\n  logout(): void\r\n  ```\r\n- **Internal Implementation**: `WritableSignal` for state, `computed()` for derived state\r\n- **Dependencies**: None (standalone service)\r\n\r\n### 2. AdminLayoutComponent\r\n\r\n- **Location**: `@core/layout/admin-layout/admin-layout.component.ts`\r\n- **Purpose**: Post-login shell with header, sidebar, footer, content area\r\n- **Template Structure**:\r\n  ```html\r\n  <div class=\"admin-layout\">\r\n    <app-header />\r\n    <div class=\"layout-body\">\r\n      <app-sidebar />\r\n      <main class=\"content\">\r\n        <router-outlet />\r\n      </main>\r\n    </div>\r\n    <app-footer />\r\n  </div>\r\n  ```\r\n- **Dependencies**: HeaderComponent, SidebarComponent, FooterComponent, RouterOutlet\r\n\r\n### 3. BlankLayoutComponent\r\n\r\n- **Location**: `@core/layout/blank-layout/blank-layout.component.ts`\r\n- **Purpose**: Minimal layout for pre-login pages (login, register, etc.)\r\n- **Template Structure**:\r\n  ```html\r\n  <div class=\"blank-layout\">\r\n    <router-outlet />\r\n  </div>\r\n  ```\r\n- **Dependencies**: RouterOutlet\r\n\r\n### 4. HeaderComponent\r\n\r\n- **Location**: `@core/layout/header/header.component.ts`\r\n- **Purpose**: Top navigation bar with logo, menu toggle, user menu\r\n- **Inputs**: None\r\n- **Outputs**: `menuToggle: OutputEmitterRef<void>`\r\n- **Dependencies**: AuthService (for user display)\r\n\r\n### 5. SidebarComponent\r\n\r\n- **Location**: `@core/layout/sidebar/sidebar.component.ts`\r\n- **Purpose**: Left navigation menu with collapsible state\r\n- **Inputs**: `collapsed: InputSignal<boolean>`\r\n- **Outputs**: None\r\n- **State**: Navigation items, active route tracking\r\n- **Dependencies**: Router, AuthService\r\n\r\n### 6. FooterComponent\r\n\r\n- **Location**: `@core/layout/footer/footer.component.ts`\r\n- **Purpose**: Bottom bar with copyright and version info\r\n- **Dependencies**: APP_CONFIG (for version)\r\n\r\n### 7. HomeComponent\r\n\r\n- **Location**: `@features/home/home.component.ts`\r\n- **Purpose**: Landing page after login\r\n- **Dependencies**: AuthService\r\n\r\n### 8. LoginComponent\r\n\r\n- **Location**: `@features/auth/login/login.component.ts`\r\n- **Purpose**: Login form (mock implementation)\r\n- **Dependencies**: AuthService, Router\r\n\r\n### 9. NotFoundComponent\r\n\r\n- **Location**: `@features/not-found/not-found.component.ts`\r\n- **Purpose**: 404 error page with navigation back to home\r\n- **Dependencies**: Router\r\n\r\n### 10. GlobalErrorHandler\r\n\r\n- **Location**: `@core/services/error.handler.ts`\r\n- **Purpose**: Catch unhandled errors application-wide\r\n- **Implementation**: Implements `ErrorHandler` interface\r\n- **Dependencies**: None\r\n\r\n### 11. AuthInterceptor\r\n\r\n- **Location**: `@core/auth/auth.interceptor.ts`\r\n- **Purpose**: Attach auth headers, handle 401/403 responses\r\n- **Type**: Functional interceptor (`HttpInterceptorFn`)\r\n- **Dependencies**: AuthService\r\n\r\n### 12. ErrorInterceptor\r\n\r\n- **Location**: `@core/services/error.interceptor.ts`\r\n- **Purpose**: Transform HTTP errors to consistent format\r\n- **Type**: Functional interceptor (`HttpInterceptorFn`)\r\n- **Dependencies**: None\r\n\r\n---\r\n\r\n## Data Models\r\n\r\n### User\r\n\r\n```typescript\r\n// @core/auth/auth.types.ts\r\nexport interface User {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n  avatar?: string;\r\n}\r\n```\r\n\r\n### LoginCredentials\r\n\r\n```typescript\r\n// @core/auth/auth.types.ts\r\nexport interface LoginCredentials {\r\n  email: string;\r\n  password: string;\r\n}\r\n```\r\n\r\n### AppConfig\r\n\r\n```typescript\r\n// @core/config/app.config.ts\r\nexport interface AppConfig {\r\n  apiUrl: string;\r\n  appName: string;\r\n  version: string;\r\n}\r\n\r\nexport const APP_CONFIG = new InjectionToken<AppConfig>('APP_CONFIG');\r\n```\r\n\r\n### NavItem\r\n\r\n```typescript\r\n// @core/layout/sidebar/nav-item.model.ts\r\nexport interface NavItem {\r\n  label: string;\r\n  icon: string;\r\n  route: string;\r\n  children?: NavItem[];\r\n}\r\n```\r\n\r\n---\r\n\r\n## Error Handling\r\n\r\n### Error Scenarios\r\n\r\n1. **Unhandled Runtime Error**\r\n   - **Handling**: GlobalErrorHandler catches and logs to console\r\n   - **User Impact**: Application continues running; error logged for debugging\r\n\r\n2. **HTTP 401 Unauthorized**\r\n   - **Handling**: AuthInterceptor detects 401, triggers logout, redirects to login\r\n   - **User Impact**: Redirected to login page with session expired message (placeholder)\r\n\r\n3. **HTTP 500 Server Error**\r\n   - **Handling**: ErrorInterceptor transforms to consistent error format\r\n   - **User Impact**: Generic error message displayed (placeholder for toast/notification)\r\n\r\n4. **Network Error**\r\n   - **Handling**: ErrorInterceptor catches network failures\r\n   - **User Impact**: Offline indicator or retry prompt (placeholder)\r\n\r\n---\r\n\r\n## Routing Design\r\n\r\n### Route Configuration\r\n\r\n```typescript\r\n// app.routes.ts\r\nexport const routes: Routes = [\r\n  { path: '', redirectTo: '/home', pathMatch: 'full' },\r\n  {\r\n    path: '',\r\n    component: AdminLayoutComponent,\r\n    canActivate: [authGuard],\r\n    children: [\r\n      {\r\n        path: 'home',\r\n        loadComponent: () => import('@features/home/home.component')\r\n          .then(m => m.HomeComponent),\r\n        title: 'Home'\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    path: 'auth',\r\n    component: BlankLayoutComponent,\r\n    children: [\r\n      {\r\n        path: 'login',\r\n        loadComponent: () => import('@features/auth/login/login.component')\r\n          .then(m => m.LoginComponent),\r\n        title: 'Login'\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    path: '**',\r\n    loadComponent: () => import('@features/not-found/not-found.component')\r\n      .then(m => m.NotFoundComponent),\r\n    title: '404 - Not Found'\r\n  }\r\n];\r\n```\r\n\r\n### Auth Guard (Placeholder)\r\n\r\n```typescript\r\n// @core/auth/auth.guard.ts\r\nexport const authGuard: CanActivateFn = () => {\r\n  // Placeholder: always returns true for skeleton\r\n  // Future: inject(AuthService).isLoggedIn()\r\n  return true;\r\n};\r\n```\r\n\r\n---\r\n\r\n## Visual System Design\r\n\r\n### Tailwind CSS Configuration\r\n\r\n- **Version**: Tailwind CSS v4 (already in package.json)\r\n- **Integration**: Via `@tailwindcss/postcss` plugin\r\n- **Global Styles**: Applied in `src/styles.css`\r\n\r\n### PrimeNG Configuration\r\n\r\n- **Version**: PrimeNG 21.0.0-rc.1\r\n- **Theme**: Aura theme from `@primeuix/themes`\r\n- **Integration**: `providePrimeNG()` in `app.config.ts`\r\n\r\n### CSS Reset & Typography\r\n\r\n```css\r\n/* src/styles.css */\r\n@import \"tailwindcss\";\r\n\r\n/* CSS Reset via Tailwind's preflight */\r\n/* Font configuration */\r\n:root {\r\n  --font-family: 'Inter', system-ui, -apple-system, sans-serif;\r\n}\r\n\r\nbody {\r\n  font-family: var(--font-family);\r\n  @apply bg-gray-50 text-gray-900;\r\n}\r\n```\r\n\r\n### Layout Responsive Breakpoints\r\n\r\n| Breakpoint | Width | Sidebar Behavior |\r\n|------------|-------|------------------|\r\n| Mobile | < 768px | Hidden, hamburger toggle |\r\n| Tablet | 768px - 1024px | Collapsed by default |\r\n| Desktop | > 1024px | Expanded by default |\r\n\r\n---\r\n\r\n## Testing Strategy\r\n\r\n### Unit Testing (Vitest)\r\n\r\n- **AuthService**: Test Signal state transitions (login/logout)\r\n- **Interceptors**: Test request/response transformations\r\n- **Guards**: Test route protection logic\r\n\r\n### Integration Testing\r\n\r\n- **Layout Components**: Verify header/sidebar/footer render correctly\r\n- **Routing**: Verify lazy loading and guard behavior\r\n\r\n### End-to-End Testing (Future)\r\n\r\n- **User Journey**: Navigate through home, login, 404 pages\r\n- **Responsive**: Verify layout adapts to viewport sizes\r\n\r\n---\r\n\r\n## File Creation Checklist\r\n\r\n### Core Layer\r\n\r\n- [ ] `src/app/core/auth/auth.types.ts`\r\n- [ ] `src/app/core/auth/auth.service.ts`\r\n- [ ] `src/app/core/auth/auth.guard.ts`\r\n- [ ] `src/app/core/auth/auth.interceptor.ts`\r\n- [ ] `src/app/core/config/app.config.ts`\r\n- [ ] `src/app/core/services/error.handler.ts`\r\n- [ ] `src/app/core/services/error.interceptor.ts`\r\n- [ ] `src/app/core/layout/admin-layout/admin-layout.component.ts`\r\n- [ ] `src/app/core/layout/blank-layout/blank-layout.component.ts`\r\n- [ ] `src/app/core/layout/header/header.component.ts`\r\n- [ ] `src/app/core/layout/sidebar/sidebar.component.ts`\r\n- [ ] `src/app/core/layout/sidebar/nav-item.model.ts`\r\n- [ ] `src/app/core/layout/footer/footer.component.ts`\r\n\r\n### Shared Layer\r\n\r\n- [ ] `src/app/shared/ui/.gitkeep`\r\n- [ ] `src/app/shared/pipes/.gitkeep`\r\n- [ ] `src/app/shared/directives/.gitkeep`\r\n- [ ] `src/app/shared/utils/.gitkeep`\r\n\r\n### Features Layer\r\n\r\n- [ ] `src/app/features/home/home.routes.ts`\r\n- [ ] `src/app/features/home/home.component.ts`\r\n- [ ] `src/app/features/auth/auth.routes.ts`\r\n- [ ] `src/app/features/auth/login/login.component.ts`\r\n- [ ] `src/app/features/not-found/not-found.component.ts`\r\n\r\n### Configuration\r\n\r\n- [ ] `tsconfig.json` - Add path aliases\r\n- [ ] `src/styles.css` - Tailwind + reset + fonts\r\n- [ ] `src/app/app.config.ts` - Update with providers\r\n- [ ] `src/app/app.routes.ts` - Complete routing\r\n- [ ] `src/app/app.component.ts` - Minimal shell\r\n",
  "fileStats": {
    "size": 14009,
    "lines": 474,
    "lastModified": "2025-12-05T00:31:48.078Z"
  },
  "comments": []
}